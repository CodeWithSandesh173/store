<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details | Dev Sandesh Store</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Outfit:wght@700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>

    <!-- Nav -->
    <div class="container">
        <nav>
            <a href="index.html" class="logo">DEV SANDESH STORE</a>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="index.html#products">Products</a>
                <a href="login.html" class="btn btn-primary" style="padding: 8px 16px; font-size: 0.8rem;">Login</a>
            </div>
        </nav>
    </div>

    <div class="container detail-container">
        <!-- Left: Image -->
        <div>
            <img id="productImg" src="" alt="Product Image" class="detail-img">
        </div>

        <!-- Right: Info -->
        <div>
            <h1 id="productName" style="font-size: 2.5rem; margin-bottom: 10px;">Loading...</h1>
            <p id="productDesc" style="color: var(--text-muted); margin-bottom: 30px;"></p>

            <h3 style="margin-bottom: 20px;">Select Package:</h3>
            <div id="packageGrid" class="package-grid">
                <!-- Options injected by JS -->
            </div>

            <div style="margin-top: 30px; border-top: 1px solid var(--border); padding-top: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <span style="font-size: 1.2rem;">Total Price:</span>
                    <span id="totalPrice" class="price-tag">Rs. 0</span>
                </div>
                <button id="buyBtn" class="btn btn-primary" style="width: 100%; font-size: 1.2rem;" disabled>Proceed to
                    Checkout</button>
                <p style="color: #ff4d4d; margin-top: 10px; display: none;" id="selectErr">Please select a package
                    first.</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container" style="text-align: center;">
            <p>&copy; 2026 Dev Sandesh Store. All rights reserved.</p>
            <div style="margin: 15px 0;">
                <a href="https://discord.gg/TbBqXaVsJs" target="_blank"
                    style="color: #fff; margin: 0 10px; text-decoration: none;">Join Discord</a>
                |
                <a href="https://www.instagram.com/devstorenepal/" target="_blank"
                    style="color: #fff; margin: 0 10px; text-decoration: none;">Follow on Instagram</a>
            </div>
            <p style="font-size: 0.8rem; margin-top: 10px; opacity: 0.6;">Delivery within 48 hours guaranteed or full
                refund.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="js/data.js"></script>
    <script>
        // Get Product ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const productId = urlParams.get('id');
        const product = products[productId];

        if (!product) {
            window.location.href = 'index.html'; // Redirect if invalid
        }

        // Render Page
        document.title = product.name + " | Dev Sandesh Store";
        document.getElementById('productImg').src = product.image;
        document.getElementById('productName').textContent = product.name;
        document.getElementById('productDesc').textContent = product.description;

        const packageGrid = document.getElementById('packageGrid');
        const totalPriceEl = document.getElementById('totalPrice');
        const buyBtn = document.getElementById('buyBtn');
        let selectedPackage = null;

        product.packages.forEach((pkg, index) => {
            const div = document.createElement('div');
            div.className = 'package-option';
            div.innerHTML = `
                <div style="font-weight: bold; font-size: 1.1rem;">${pkg.label}</div>
                <div style="color: var(--primary);">Rs. ${pkg.price}</div>
            `;
            div.onclick = () => selectPackage(index, div);
            packageGrid.appendChild(div);
        });

        function selectPackage(index, element) {
            // Remove active class from all
            document.querySelectorAll('.package-option').forEach(el => el.classList.remove('active'));
            // Add to clicked
            element.classList.add('active');

            selectedPackage = product.packages[index];
            totalPriceEl.textContent = `Rs. ${selectedPackage.price}`;
            buyBtn.disabled = false;
            document.getElementById('selectErr').style.display = 'none';
        }

        buyBtn.onclick = () => {
            if (!selectedPackage) {
                document.getElementById('selectErr').style.display = 'block';
                return;
            }
            // Go to checkout with data
            // We'll pass product ID and the specific package details via URL to keep it simple
            const checkoutUrl = `checkout.html?id=${productId}&pkgLabel=${encodeURIComponent(selectedPackage.label)}&pkgPrice=${selectedPackage.price}`;
            window.location.href = checkoutUrl;
        };

    </script>
</body>

</html>